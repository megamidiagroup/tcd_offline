{% extends 'admin/change_list.html' %}

{% load i18n relatorio %}

{% block breadcrumbs %}

    <div class="breadcrumbs"><a href="/admin/">{% trans 'Home' %}</a>{% if title %} &rsaquo; Relatório de Treinamentos Concluídos do Aluno{% endif %}</div>

{% endblock breadcrumbs %}

{% block content_title %}{% endblock content_title %}

{% block content %}

    <script src="{{ STATIC_URL_TCD }}{{ get_tipo_template|default:'mega' }}/js/jquery-1.7.2.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL_TCD }}{{ get_tipo_template|default:'mega' }}/js/select_admin.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL_TCD }}{{ get_tipo_template|default:'mega' }}/js/jquery.maskedinput-1.3.min.js" type="text/javascript"></script>

    <h1>Lista de Relatório de Treinamentos Concluídos do Aluno</h1>

    <div id="content-main">

        <div id="changelist" class="module filtered">
        	
        	<div id="toolbar">
        		<form method="get" action="" id="changelist-search">
					<div><!-- DIV needed for valid HTML -->
						<label for="searchbar">
							<img alt="Search" src="{{ ADMIN_MEDIA_PREFIX }}img/admin/icon_searchbox.png" border="0" />
						</label>
						<input type="text" id="searchbar" value="{{ q|default:'' }}" name="q" size="40" />
						Periodo de:
						<input type="text" class="date" id="txt_de" value="{{ de }}" name="de" size="8" />
						até:
						<input type="text" class="date" id="txt_ate" value="{{ ate }}" name="ate" size="8" />
						<input type="submit" value="Pesquisar" />
					</div>
				</form>
				<script type="text/javascript">
					$("#searchbar").focus();
            		$(".date").mask("99/99/9999");
				</script>
			</div>

            <div id="changelist-filter">
                <h2>Filtro</h2>

				{% if list_rede %}
	                <h3>Por Rede</h3>
	                <ul>
	                    <li class="{% if not rede__exact %}selected{% endif %}">
	                        <a href="?">Todos</a>
	                    </li>
	                    {% for i in list_rede %}
	                        <li class="{% if rede__exact == i.id|safe %}selected{% endif %}">
	                            <a href="?rede__exact={{ i.id }}">{{ i.name }}</a>
	                        </li>
	                    {% endfor %}
	                </ul>
                {% endif %}

                <h3>Por Filial</h3>
                <ul>
                    <li class="{% if not filial__exact %}selected{% endif %}">
                        <a href="?">Todos</a>
                    </li>
                    <li class="{% if filial__exact == 'null' %}selected{% endif %}">
                        <a href="?filial__exact=null">(nenhum)</a>
                    </li>
                    {% for i in list_filial %}
                        <li class="{% if filial__exact == i.id|safe %}selected{% endif %}">
                            <a href="?filial__exact={{ i.id }}">{{ i.name }}</a>
                        </li>
                    {% endfor %}
                </ul>

                <h3>Por Habilitado</h3>
                <ul>
                    <li class="{% if not visible__exact %}selected{% endif %}">
                        <a href="?">Todos</a>
                    </li>
                    <li class="{% if visible__exact == '1' %}selected{% endif %}">
                        <a href="?visible__exact=1">Sim</a>
                    </li>
                    <li class="{% if visible__exact == '0' %}selected{% endif %}">
                        <a href="?visible__exact=0">Não</a>
                    </li>
                </ul>

            </div>

            <form method="post" action="./" id="changelist-form">

                {% csrf_token %}

                <div class="actions">

                    <label>
                        Ação:
                        <select name="action">
                            <option selected="selected" value="">---------</option>
                            <option value="export_selected">Exportar os Treinamentos Concluídos do Aluno</option>
                        </select>
                    </label>

                    <button value="0" name="index" title="Executar ação selecionada" class="button" type="button">Ir</button>

                    <script type="text/javascript">var _actions_icnt="{{ result_list.count }}";</script>

                    <span class="action-counter" style="display: inline;">0 de {{ result_list.count }} selecionados</span>

                </div>

                <div class="results">
                    <table cellspacing="0" id="result_list">
                        <tr>
                            <th class="action-checkbox-column" scope="col">
                                <input type="checkbox" id="action-toggle" style="display: inline;">
                            </th>
                            <th scope="col">
                                <a href="?ot=asc&amp;o=first_name">
                                    Nome
                                </a>
                            </th>
                            <th scope="col">
                                <a href="?ot=asc&amp;o=username">
                                    Usuário
                                </a>
                            </th>
                            <th scope="col">
                                <a href="?ot=asc&amp;o=infouser__rede">
                                    Rede
                                </a>
                            </th>
                            <th scope="col">
                                <a href="?ot=asc&amp;o=infouser__filial">
                                    Filial
                                </a>
                            </th>
                            <th class="sorted ascending" scope="col">
                                Treinamentos Concluidos
                            </th>
                            <th class="sorted ascending" scope="col">
                                <a href="?ot=asc&amp;o=is_active">
                                    Habilitado
                                </a>
                            </th>
                        </tr>

                        {% for i in result_list %}

                            <tr class="row1">
                                <td class="action-checkbox" style="text-align: left;">
                                    <input type="checkbox" name="_selected_action" value="{{ i.id }}" class="action-select">
                                </td>
                                <td>
                                    <a href="/admin/auth/user/{{ i.id }}/">{{ i.get_full_name }}</a>
                                </td>
                                <td class="nowrap">{{ i.username }}</td>
                                <td class="nowrap">{{ i.infouser.rede }}</td>
                                <td>{{ i.infouser.filial|default:'(nenhum)' }}</td>
                                <td>{{ i|counttreinamentorealizado:i.infouser.rede }}</td>
                                <td>
                                    {% if i.is_active %}
                                        <img alt="Sim" src="{{ ADMIN_MEDIA_PREFIX }}img/admin/icon-yes.gif" border="0" />
                                    {% else %}
                                        <img alt="Não" src="{{ ADMIN_MEDIA_PREFIX }}img/admin/icon-no.gif" border="0" />
                                    {% endif %}
                                </td>
                            </tr>

                        {% endfor %}

                    </table>
                </div>

                <p class="paginator">{{ result_list.count }} Aluno{{ result_list.count|pluralize }} Cadastrado{{ result_list.count|pluralize }}</p>

            </form>
        </div>
    </div>

    <br class="clear" />

{% endblock %}